# Flag_after_118_years

- **Category**: Reversing  
- **Solution**:  bypass or edit sleep function.


| Step | Screenshot |
|------|------------|
|1. Download `nctf_bin_after118years` to your preferred location.<br>As planned, analyze the binary using WSL or a VM.<br>It looks like a Linux ELF binary. When you run it, the message "Analyzing system......" is displayed, but nothing else happens.|<img width="1100" height="158" alt="image" src="https://github.com/user-attachments/assets/e2207beb-79b1-4166-b38a-da274c72c59d" />|
|2. After waiting for a few minutes, still nothing happens. Let's check which functions are used with `nm`.<br>`nm nctf_bin_after118years`|<img width="559" height="533" alt="image" src="https://github.com/user-attachments/assets/fa097159-ea1b-4158-8977-70ac19f91b51" />|
|3. From the result, we can see `main`, `puts`, and also the `sleep` function being called. The binary seems to wait because of the sleep function.|<img width="500" height="73" alt="image" src="https://github.com/user-attachments/assets/8dd73724-7919-47fd-bd85-96f84ce6c359" />|
|4. Well, then what time do we have to wait?. there should be stucked arg, try looking at the binary with `objdump`<br>`objdump -M intel -D -j .text nctf_bin_after118years\|grep "<main>:" -A 70`|<img width="752" height="250" alt="image" src="https://github.com/user-attachments/assets/7d32c0f1-7102-438f-8371-a6f8a4ad713c" />|
|5. Appealentry it is stucked `0xdeadbeef`. what seconds is `0xdeadbeef`? according to Google, 3735928559(decimal) / 3.154e+7 = about 118 years. we don't wait for years so change the value of 0xdeadbeef you prefered way. |<img width="821" height="237" alt="image" src="https://github.com/user-attachments/assets/51af1a59-4cf1-4cf2-b383-e5581767f572" />|
|6. The way of 1<br>`hexedit`<br>`hexedit nctf_bin_after118years`<br>Press `/` and input the value (byte order: little-endian) `ef be ad de` ([Little-endian explanation](https://e-words.jp/w/%E3%83%AA%E3%83%88%E3%83%AB%E3%82%A8%E3%83%B3%E3%83%87%E3%82%A3%E3%82%A2%E3%83%B3.html)).<br>Next, change the value to `01 00 00 00` â€» represents 1 second.<br>Press `Ctrl + x` and confirm with `yes`.<br>Run the binary.<br><br>ðŸŽ‰ Congratulations! You found the flag!|<img width="778" height="209" alt="image" src="https://github.com/user-attachments/assets/b6ec2c4a-0ad7-4979-98ef-5ec3e82d238d" /><img width="492" height="80" alt="image" src="https://github.com/user-attachments/assets/2f83ddd3-a4cc-4044-bacb-6d6a42967ec7" />|
|7. The way of 2-1<br>`gdb`<br>`gdb -q nctf_bin_after118years`<br>`set disassembly-flavor intel` â€» optional<br>`disas main`<br>Check the position of the `sleep` function.|<img width="918" height="471" alt="image" src="https://github.com/user-attachments/assets/26530ab6-83bc-4992-88bb-ead695d8200e" /><img width="930" height="405" alt="image" src="https://github.com/user-attachments/assets/7346283e-fc84-4c9a-9cba-892205a6297e" />|
|7. The way of 2-2<br>Set a breakpoint at the `sleep` function:<br>`b *main+263`<br>`run`<br>The program will stop before executing the `sleep` function.|<img width="370" height="67" alt="image" src="https://github.com/user-attachments/assets/e4e0b7cd-f7dc-4c98-a85c-0182ab931dcf" /><img width="1058" height="425" alt="image" src="https://github.com/user-attachments/assets/dbc31f3a-de03-40fb-8cd1-de25473a1048" /><br>When the program stops, run `disas main` again.|
|7. The way of 2-3<br>Jump over the `sleep` function:<br>`i r` â€» alias for `info registers`<br>[rdi](https://qiita.com/Ll_e_ki/items/fd098cb6d1b6390a76e7) value is `0xdeadbeef` and [rip](https://qiita.com/Ll_e_ki/items/fd098cb6d1b6390a76e7) value is `0x555555555290` (example environment).<br>Change `rip` to the next instruction:<br>`set $rip=0x0000555555555295` (adjust according to your environment)<br>Then continue the program with `c` â€» alias for `continue`.<br><br>ðŸŽ‰ Congratulations! You found the flag!|<img width="803" height="454" alt="image" src="https://github.com/user-attachments/assets/3125e239-e503-4585-8ae8-57063576425c" /><img width="866" height="343" alt="image" src="https://github.com/user-attachments/assets/758052bd-8ca0-4c3e-9b36-54c507e7b0b6" /><img width="465" height="107" alt="image" src="https://github.com/user-attachments/assets/a2199569-6eea-4d3c-9f83-9f4f9d27a38e" />|
